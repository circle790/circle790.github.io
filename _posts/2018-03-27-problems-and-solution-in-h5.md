---
layout: post
#标题配置
title:  "移动端常规业务总结"
#时间配置
date:   2018-03-27 11:26:00 +0800
categories: Solutions
tag: Mobile
---

* content
{:toc}

引言
------------------------


说明
------------------------

**1、关于微信分享卡片**

自定义微信分享卡片需要接入微信JSSDK，访问[微信JS-SDK说明文档](https://mp.weixin.qq.com/wiki?t=resource/res_main&id=mp1421141115)，通过使用微信JS-SDK，网页开发者可借助微信高效地使用拍照、选图、语音、位置等手机系统的能力，同时可以直接使用微信分享、扫一扫、卡券、支付等微信特有的能力，为微信用户提供更优质的网页体验。如果仅仅只是想设置分享卡片内容，不妨试试这种方式。

- 默认获取页面中title内容作为分享卡片标题
- 默认获取页面中第一张格式大于300*300像素（据说是阅读源码发现）的图片作为分享卡片右侧图标
- 描述内容为当前分享页面地址

![wechat_share]({{ '/styles/images/share.png' | prepend: site.baseurl  }})

需要注意的是，通常H5的使用场景不仅仅局限于微信，还包括各种类型的浏览器，分享操作的流程各不相同，我们知道微信的分享按钮在标题右上角的三个圆点，而其他的浏览器则没有那么一致了，有的在标题右上角，有的在标题左上角，更多的是显示在底部工具栏菜单里面，所在位置也不确定，提出这样的需求的时候，一定要在前期告知需求方并沟通好分享操作流程的提示形式。对于分享出现的卡片样式，各浏览器形态各异，好在内容总体相同，主要是标题，图标和描述，标题取自页面的title标签触发分享前动态设置没有问题，图标在微信是取页面中首张格式大于300*300像素的图片，而QQ浏览器则是取页面的部分截图，其他浏览器不得而知，描述内容有显示分享页面地址的也有的与标题一致添加了类似'我正在看'前缀和'@XX浏览器'后缀，分享到朋友圈则不显示描述文字，只显示标题文字和图标，可以坑定的是没有特定场景的时候在分享卡片上大作文章无异于徒劳，还不如去看看一下晚上吃什么。

除此之外，可能我们还有这样一种分享需求，指定分享页面的地址，做惯hybridApp内嵌webView形式的FE来说随口就答应了，因为我们调用客户端封装的交互能力可以方便的指定一个分享的页面地址，丝毫没有拒绝的理由，直到实现的过程中才会发现原来无论是微信还是其他浏览器分享出去的页面地址就是当前访问地址，不存在指定分享地址的API（即使微信也需要接入微信JSSDK），那有什么权益之策么，恩，是有的，回顾一下移动端浏览器分享整个流程，为了引导用户进行分享，在所有的浏览器进行分享都会进行一个分享引导，形式由自己指定，或半透明或白底或许全屏或许局部，就看默契程度了，具体做法就是在弹出引导时我们在用户毫无感知的情况下将后面的页面切换至分享目标地址页面，这样分享出去的页面地址就是目标地址了，当然考虑到用户放弃分享操作关闭引导，我们需要在关闭引导之前将页面切换回之前的页面。到这里远远没有结束，我们进行一下分享测试，可能发现分享的地址并不是目标地址而是进入时的页面地址，取决于切换页面的方式，使用vue-router进行管理路由，微信浏览器是不接受的。history模式下也许不存在这种问题（因为此模式涉及到服务端，基于项目没有做过多尝试），我使用的是hash模式，调用导航方法（push、replace、go）对访问记录进行堆栈处理，坑点就是，对于href的解释vue-router与规范是不相符合的，hash模式使用哈希值变化记录路由决定动态插入页面内容，query参数是放在哈希值后面，规范的解释是hash是放在地址最后，search参数在前面，回到问题中来，如此切换页面时微信在地址上拼接了几个参数from，installed等，导致页面虽然切换但是地址却没有改变，没有办法放弃使用vue-router使用原生的location切换页面总是接受的，却失去了vuex进行统一状态管理的能力，项目如果足够复杂需要一定的权衡。

**2、唤醒App页面和引导下载**


---------
持续更新...

---------


